<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Marsh的博客">
    <meta name="author" content="Marsh">
    
    <title>
        
            Python如何与MySQL实现交互及常用sql语句 |
        
        Marsh
    </title>
    
<link rel="stylesheet" href="../css/style.css">

    <link rel="shortcut icon" href="../../../../images/logo.jpeg">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/fontawesome.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/regular.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/solid.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/brands.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"en","path":"search.json"}
    KEEP.theme_config = {"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true},"style":{"primary_color":"#c0392b","logo":"/images/logo.jpeg","favicon":"/images/logo.jpeg","avatar":"/images/avatar.jpeg","font_size":"16px","font_family":null,"hover":{"shadow":true,"scale":true},"first_screen":{"enable":true,"header_transparent":true,"background_img":"/images/bg.svg","description":"Keep writing and Keep loving.","font_color":null,"hitokoto":true},"scroll":{"progress_bar":true,"percent":true}},"local_search":{"enable":true,"preload":true},"code_copy":{},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"default"},"side_tools":{},"pjax":{"enable":true},"lazyload":{"enable":true},"comment":{"enable":true,"use":"gitalk","valine":{"appId":"JThobepyUWZ8wrCKpWzo5Vju-gzGzoHsz","appKey":"5l7p5rk6oXtEIST5bExEAMrT","server_urls":null,"placeholder":"留下点足迹~# Input box placeholder"},"gitalk":{"github_id":"jaling9","github_admins":"jaling9","repository":"hexo-site-coments","client_id":"ab165842dc9a64de37e9# GitHub Application Client ID","client_secret":"96d2589a9e0310efa2bf996a5f5e88ef8b7b3557#","proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.8"},"waline":{"server_url":null,"reaction":false,"version":2}},"post":{"author_label":{"enable":true,"auto":true,"custom_label_list":["摸不到门","半只脚入门","入门"]},"word_count":{"enable":true,"wordcount":true,"min2read":true},"img_align":"left","copyright_info":true},"version":"3.6.1"}
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"}
    KEEP.language_code_block = {"copy":"Copy code","copied":"Copied","fold":"Fold code block","folded":"Folded"}
    KEEP.language_copy_copyright = {"copy":"Copy copyright info","copied":"Copied","title":"Original article title","author":"Original article author","link":"Original article link"}
  </script>
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <i class="pjax-progress-icon fas fa-circle-notch fa-spin"></i>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
                <a class="logo-image" href="/">
                    <img src="../../../../images/logo.jpeg">
                </a>
            
            <a class="logo-title" href="/">
               Marsh
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="../../../../index.html"
                            >
                                HOME
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="../../../../archives"
                            >
                                ARCHIVES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="../../../../tags"
                            >
                                TAGS
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="../../../../categories"
                            >
                                CATEGORIES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="../../../../links"
                            >
                                LINKS
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="../../../../about"
                            >
                                ABOUT
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="../../../../index.html">HOME</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="../../../../archives">ARCHIVES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="../../../../tags">TAGS</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="../../../../categories">CATEGORIES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="../../../../links">LINKS</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="../../../../about">ABOUT</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="post-page-container">
        <div class="article-content-container">

            <div class="article-title">
                <span class="title-hover-animation">Python如何与MySQL实现交互及常用sql语句</span>
            </div>

            
                <div class="article-header">
                    <div class="avatar">
                        <img src="../../../../images/avatar.jpeg">
                    </div>
                    <div class="info">
                        <div class="author">
                            <span class="name">Marsh</span>
                            
                                <span class="author-label">Lv3</span>
                            
                        </div>
                        <div class="meta-info">
                            
<div class="article-meta-info">
    <span class="article-date article-meta-item">
        
            <i class="fa-regular fa-calendar-plus"></i>&nbsp;
        
        <span class="pc">2022-11-12 16:45:09</span>
        <span class="mobile">2022-11-12 16:45</span>
    </span>
    
        <span class="article-update-date article-meta-item">
        <i class="fas fa-file-pen"></i>&nbsp;
        <span class="pc">2022-11-15 01:16:01</span>
    </span>
    
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="../../../../categories/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">数据分析</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="../../../../tags/%E8%BD%AC%E8%BD%BD/">转载</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="../../../../tags/Python/">Python</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="../../../../tags/MySQL/">MySQL</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>2.5k Words</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>9 Mins</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                        </div>
                    </div>
                </div>
            

            <div class="article-content keep-markdown-body">
                

                <p>9 月初，我对 <code>python 爬虫</code> 燃起兴趣，但爬取到的数据多通道实时同步读写用<code>文件</code>并不方便，于是开始用起<code>mysql</code>。这篇笔记，我将整理近一个月的实战中最常用到的 <code>mysql</code> 语句，同时也将涉及到如何在<code>python3</code>中与 <code>mysql</code> 实现数据交换。</p>
<p>关于工具&#x2F;库，特别说明下：</p>
<p>1、我安装了 <code>mysql</code> ，并直接采用管理员身份运行<code>命令行提示符（cmd）</code>查看 <code>mysql</code>，并没有安装任何 <code>mysql</code> 的可视化图形界面工具。</p>
<p>2、在 <code>python</code> 脚本中，我采用 <code>pymysql</code> 和 <code>sqlalchemy</code> 这两个库与 <code>mysql</code> 建立连接，用 <code>pandas</code> 来处理数据。</p>
<h2 id="一、建立连接与数据交互"><a href="#一、建立连接与数据交互" class="headerlink" title="一、建立连接与数据交互"></a>一、建立连接与数据交互</h2><p>与 mysql 交互的方式，我目前共使用 4 种。其中采用管理员身份运行<code>命令行提示符（cmd）</code>查看 <code>mysql</code>，其操作图示可另写一篇。这里就不占篇幅了。mysql的可视化图形界面工具，我目前并没有用到，也没有迫切使用它的需要。另外 3 种方式都是通过 python 脚本进行。</p>
<h3 id="情境A：python-演算得出数据，想要写入数据库"><a href="#情境A：python-演算得出数据，想要写入数据库" class="headerlink" title="情境A：python 演算得出数据，想要写入数据库"></a>情境A：python 演算得出数据，想要写入数据库</h3><p>python 脚本已得到表格类大量数据，想要一次性写入数据库，常用代码如下：</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token comment"># 与 mysql 建立连接</span>
<span class="token keyword">from</span> sqlalchemy <span class="token keyword">import</span> create_engine
conn_eng <span class="token operator">=</span> create_engine<span class="token punctuation">(</span><span class="token string">'mysql+pymysql://username:password@localhost:3306/databasename'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>  

<span class="token comment"># 调用 pandas 的方法，数据写入mysql</span>
pd<span class="token punctuation">.</span>io<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>to_sql<span class="token punctuation">(</span>your_df<span class="token punctuation">,</span> <span class="token string">"table_name"</span><span class="token punctuation">,</span> conn_eng<span class="token punctuation">,</span> if_exists<span class="token operator">=</span><span class="token string">'append'</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre></div></figure>

<p>表格类数据，我用的是 <code>pandas</code> 的 <code>dataframe</code> 结构。<code>pd.io.sql.to_sql()</code> 的参数还有许多其它用途，但上面这种是我个人使用最高频的。效果是：无需自己提前建表，将自动建新表。美中不足是：表的列属性自动生成，通常不合心意，还需检查和修改。</p>
<p>如果不想用 <code>pd.io.sql.to_sql()</code> 或者想更精细、复杂的操作，则用到下面的情境C。</p>
<h3 id="情境B：python-脚本想从-mysql-拿到数据"><a href="#情境B：python-脚本想从-mysql-拿到数据" class="headerlink" title="情境B：python 脚本想从 mysql 拿到数据"></a>情境B：python 脚本想从 mysql 拿到数据</h3><p>如果已经存在某个表格，想要向该表格提交某条指令，需返回数据，我用的是 <code>pandas</code>的<code>read_sql ()</code> ，返回的数据类型是 <code>pandas</code> 的 <code>dataframe</code>。sql 查询语句挺好写的，具体总结在本文下方。</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pymysql
<span class="token comment"># 与 mysql 建立连接</span>
conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">'localhost'</span><span class="token punctuation">,</span><span class="token string">'username'</span><span class="token punctuation">,</span><span class="token string">'password'</span><span class="token punctuation">,</span><span class="token string">'databasename'</span><span class="token punctuation">)</span>
<span class="token comment"># sql 语句定义为一个字符串</span>
sql_search <span class="token operator">=</span> <span class="token string">'select question_id from topic_monitor where is_title=0 ;'</span>
<span class="token comment"># 调用 pandas 的 read_sql() 方法拿到 dataframe 结构的数据</span>
question_ids <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span>sql_search<span class="token punctuation">,</span>conn<span class="token punctuation">)</span>
<span class="token comment"># 关闭连接</span>
conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div></figure>

<h3 id="情境C：python-脚本单方面向-mysql-发出指令，无需拿到数据"><a href="#情境C：python-脚本单方面向-mysql-发出指令，无需拿到数据" class="headerlink" title="情境C：python 脚本单方面向 mysql 发出指令，无需拿到数据"></a>情境C：python 脚本单方面向 mysql 发出指令，无需拿到数据</h3><p>如果已经存在某个表格，想要向该表格提交某条指令而无需返回数据时，比如：建表、对数据的增改删、对列的名称、列的属性修改等，代码如下。</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pymysql
<span class="token comment"># 与 mysql 建立连接</span>
conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">'localhost'</span><span class="token punctuation">,</span><span class="token string">'username'</span><span class="token punctuation">,</span><span class="token string">'password'</span><span class="token punctuation">,</span><span class="token string">'databasename'</span><span class="token punctuation">)</span>
cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># sql 语句定义为一个字符串，插入一行数据</span>
sql_insert <span class="token operator">=</span> <span class="token string">'INSERT INTO questions(q_id,q_title,q_description,q_keywords,q_people,q_pageview,time) VALUES( "'</span>\
                <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>quesition_id<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'", "'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>one<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span> <span class="token string">'", "'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>one<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'", "'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>one<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'", "'</span> \
                <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>one<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'", "'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>one<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'", "'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'");'</span> 
<span class="token comment"># sql 语句定义为一个字符串，修改某个数据（另一个表格）</span>
sql_update <span class="token operator">=</span> <span class="token string">'update topic_monitor SET is_title="1" where question_id = "'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>quesition_id<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'";'</span>
<span class="token comment"># 提交指令</span>
cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql_insert<span class="token punctuation">)</span>
cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql_update<span class="token punctuation">)</span>
conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 插入一行数据；仅当该数据与表格已有数据不重复时才插入，否则就不会插入</span>
sql_insert <span class="token operator">=</span> <span class="token string">'INSERT INTO `topic_monitor`(question_id,is_title,q_type,topic_id,time) SELECT "'</span>\
                    <span class="token operator">+</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'", "0", "0","'</span>  <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>topic_id<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'", "'</span><span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>now<span class="token punctuation">)</span> <span class="token operator">+</span> '" FROM DUAL WHERE NOT EXISTS<span class="token punctuation">(</span>\
                    SELECT question_id FROM topic_monitor WHERE question_id <span class="token operator">=</span> <span class="token string">"' + x[0] + '"</span><span class="token punctuation">)</span>'
cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql_insert<span class="token punctuation">)</span>
conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 关闭连接</span>
cursor<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div></figure>

<p>通过上面几种实用情况可以看到，<code>python</code> 与 <code>mysql</code> 实现交互的过程，通常分为：建立连接、把sql语句定义为字符串，提交指令、关闭连接。核心的技能在于 sql语句；除了定义sql语句字符串，其余3个处理都是固定的写法。</p>
<p>我在最初一个月的实践中，最常出现的错误有：</p>
<ul>
<li>值的引用没有加上引号；</li>
<li>符号错乱：多一个符号，少一个符号；</li>
<li>值的类型不符合：不管 mysql 表格中该值是数，还是文本，在定义 sql 语句的字符串时，对每个值都需要转化为字符串；</li>
<li>拷贝自己的代码时，忘记修改databasename。</li>
</ul>
<h2 id="二、sql语句：搜索查询"><a href="#二、sql语句：搜索查询" class="headerlink" title="二、sql语句：搜索查询"></a>二、sql语句：搜索查询</h2><p>搜索是指在数据库的某个表格中查询符合特定条件的数据，并返回查询结果。其基本结构为：</p>
<p><code>SELECT 【范围】FROM table_name 【条件】;</code> 其中，范围是必须指定的，而条件可有可无。</p>
<h3 id="变量A：范围，是指返回查询结果的范围。"><a href="#变量A：范围，是指返回查询结果的范围。" class="headerlink" title="变量A：范围，是指返回查询结果的范围。"></a>变量A：范围，是指返回查询结果的范围。</h3><p>返回该表格的所有字段，用 * 表达：</p>
<figure><div class="code-wrapper"><pre class="language-SQL" data-language="SQL"><code class="language-SQL">SELECT * FROM table_name ;</code></pre></div></figure>

<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/9/27/16d72eb3fa3da2c1~tplv-t2oaga2asx-zoom-in-crop-mark:3402:0:0:0.awebp" alt="image"></p>
<p>仅返回该表格的某个字段：</p>
<figure><div class="code-wrapper"><pre class="language-SQL" data-language="SQL"><code class="language-SQL">SELECT column_name FROM table_name ;</code></pre></div></figure>

<p>仅返回该表格的多个字段：</p>
<figure><div class="code-wrapper"><pre class="language-SQL" data-language="SQL"><code class="language-SQL">SELECT column_name_1,column_name_3,column_name_3 FROM table_name ;</code></pre></div></figure>

<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/9/27/16d72ea94e130ac7~tplv-t2oaga2asx-zoom-in-crop-mark:3402:0:0:0.awebp" alt="image"></p>
<p>仅返回符合条件的数据个数：</p>
<figure><div class="code-wrapper"><pre class="language-SQL" data-language="SQL"><code class="language-SQL">SELECT count(*) FROM table_name ;</code></pre></div></figure>

<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/9/27/16d72ea94e262e64~tplv-t2oaga2asx-zoom-in-crop-mark:3402:0:0:0.awebp" alt="image"></p>
<h3 id="变量B：条件是指，期望返回的数据满足哪些条件。"><a href="#变量B：条件是指，期望返回的数据满足哪些条件。" class="headerlink" title="变量B：条件是指，期望返回的数据满足哪些条件。"></a>变量B：条件是指，期望返回的数据满足哪些条件。</h3><p>不限定条件：</p>
<figure><div class="code-wrapper"><pre class="language-SQL" data-language="SQL"><code class="language-SQL">SELECT * FROM table_name ;</code></pre></div></figure>

<p>数值类：某个字段（数值类型的，比如double或者int），数值比较的操作符都可以使用比如，大于<code>&gt;</code>，小于<code>&lt;</code>，等于 <code>=</code> ，大于等于 <code>&gt;=</code> ，小于等于 <code>&lt;=</code> ：</p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/9/27/16d72eb3fa5311f5~tplv-t2oaga2asx-zoom-in-crop-mark:3402:0:0:0.awebp" alt="image"></p>
<figure><div class="code-wrapper"><pre class="language-SQL" data-language="SQL"><code class="language-SQL">SELECT * FROM table_name WHERE num_column_name &gt;&#x3D; 1;</code></pre></div></figure>

<p>文本类：某个字段（字符串类型的，比如char，text）：</p>
<figure><div class="code-wrapper"><pre class="language-SQL" data-language="SQL"><code class="language-SQL">SELECT * FROM table_name WHERE str_column_name like “%your_str%”;</code></pre></div></figure>

<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/9/27/16d72ea94e682c22~tplv-t2oaga2asx-zoom-in-crop-mark:3402:0:0:0.awebp" alt="image"></p>
<p>也可以表达多个条件，<code>and</code>，<code>or</code>等可用于表达条件之间的关系：</p>
<figure><div class="code-wrapper"><pre class="language-SQL" data-language="SQL"><code class="language-SQL">SELECT * FROM table_name WHERE num_column_name_1 &gt;&#x3D; 1 and  str_column_name like “%your_str%” ;</code></pre></div></figure>

<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/9/27/16d72eb3fa478de0~tplv-t2oaga2asx-zoom-in-crop-mark:3402:0:0:0.awebp" alt="image"></p>
<h2 id="三、sql语句：修改表属性"><a href="#三、sql语句：修改表属性" class="headerlink" title="三、sql语句：修改表属性"></a>三、sql语句：修改表属性</h2><p>横向的一整条数据，叫做行；竖向的一整条数据，叫作列。列的名字，叫做 <code>column</code>，这是通用的知识点。</p>
<p>这段时间的实战中，我完全没有用到修改表的名称、重设index等知识点。最常用的，就是对列进行操作。每个列具备：列的名称、列的属性、列的数值。</p>
<p>列的名称，需要留心不使用保留词。我的技巧是，尽量用一些<code>_</code>来表达该数据，比如 <code>article_title</code>，<code>press_date</code> 这种命名虽然稍长，但易读，也不会装上保留词。</p>
<p>列的属性包括：类型，最大长度，是否为空，默认值，是否重复，是否为索引。通常，直接通过 <code>pandas</code> 的 <code>pd.io.sql.to_sql()</code> 一次性创建表格并保存数据时，列的默认属性并不合需求。要么提前自己定义表的结构，设置好每列属性；要么事后检查列属性，并逐列修改。所以，列的属性设定、修改是高频基础知识点。</p>
<p>列的数值，即除了列名称外的、该列其它值。修改某个值，也是高频操作。不过我把这个知识点放到第四部分了。</p>
<p>对列的名称、列的属性进行修改，主要的关键词都是 <code>ALTER</code>，具体又分为以下几种情况。</p>
<h3 id="情境A：新增一列。关键词-ADD"><a href="#情境A：新增一列。关键词-ADD" class="headerlink" title="情境A：新增一列。关键词 ADD"></a>情境A：新增一列。关键词 <code>ADD</code></h3><p>在你所指定的 <code>column_name</code> 后面定义列的属性。</p>
<figure><div class="code-wrapper"><pre class="language-SQL" data-language="SQL"><code class="language-SQL">ALTER TABLE table_name ADD COLUMN column_name char(20);</code></pre></div></figure>

<h3 id="情境B：修改某列的名称。关键词-CHANGE"><a href="#情境B：修改某列的名称。关键词-CHANGE" class="headerlink" title="情境B：修改某列的名称。关键词 CHANGE"></a>情境B：修改某列的名称。关键词 <code>CHANGE</code></h3><p>在修改列名的同时也可以重新指定列的属性。</p>
<figure><div class="code-wrapper"><pre class="language-SQL" data-language="SQL"><code class="language-SQL">ALTER TABLE table_name CHANGE old_column_name new_column_name char(50);</code></pre></div></figure>

<h3 id="情境C：修改某列的属性。关键词是-MODIFY"><a href="#情境C：修改某列的属性。关键词是-MODIFY" class="headerlink" title="情境C：修改某列的属性。关键词是 MODIFY"></a>情境C：修改某列的属性。关键词是 <code>MODIFY</code></h3><figure><div class="code-wrapper"><pre class="language-SQL" data-language="SQL"><code class="language-SQL">ALTER TABLE table_name MODIFY column_name char(100);</code></pre></div></figure>

<h2 id="四、sql语句：数据的增改删"><a href="#四、sql语句：数据的增改删" class="headerlink" title="四、sql语句：数据的增改删"></a>四、sql语句：数据的增改删</h2><p>通常提到数据库操作时，四字以蔽之：增删改查。</p>
<ul>
<li>查询，请看第二部分。关键词是 <code>SELECT</code>。</li>
<li>对数据所依赖的属性的增、改，请看第三部分。关键词是 <code>ALTER</code>。</li>
<li>数据的增加，在第一部分的数据交互中也给出实例，就不重复了。关键词是<code>INSERT</code>。</li>
<li>数据的修改，关键词是 <code>UPDATE</code>。</li>
<li>数据（甚至表格、库）的删除，关键词是<code>DELETE</code>。</li>
</ul>
<p>数据的修改，副关键词是 <code>set</code> 。</p>
<figure><div class="code-wrapper"><pre class="language-SQL" data-language="SQL"><code class="language-SQL">UPDATE table_name SET columns_name &#x3D; new_value 【条件】;</code></pre></div></figure>

<p>新数值如果是数值类型的，则直接写数值即可；如果是文本类型的，必须要加上双引号，比如，<code>“your_new_value”</code>。</p>
<p>如果把【条件】部分不写，就相当于修改整列的值；想要修改特定范围，就要用到条件表达式，这和前面的查询部分是一致的，就不再重复。</p>
<p>数据的删除，对于新手来说，是必须警惕的操作。因为一旦误操作，你将无力挽回。即便是职业程序员，也可能犯下无疑删库的惨剧。其基本语句为：</p>
<figure><div class="code-wrapper"><pre class="language-SQL" data-language="SQL"><code class="language-SQL">DELETE FROM table_name【条件】;</code></pre></div></figure>

<p>想要修改特定范围，就要用到条件表达式，这和前面的查询部分也是一致的，稍微啰嗦两句：不要对自己设定的条件太自信，最好先用搜索语句检查一下，然后再执行删除语句。</p>
<ul>
<li>删除单行数据：添加能唯一标识该行数据的条件语句。</li>
<li>删除多行数据：添加能标识该范围的条件语句。</li>
<li>删除整张表格：<strong>你是认真的吗？没有写错表格名字吧？！</strong> 做这项操作前，必须确认清楚自己的意图，毕竟一旦发生，无可挽回。</li>
</ul>
<p>如果条件留空，将保留表结构，而删除所有数据行。想要删除整张表格，什么都不留下，则执行：</p>
<figure><div class="code-wrapper"><pre class="language-SQL" data-language="SQL"><code class="language-SQL">DELETE TABLE table_name;</code></pre></div></figure>

<p>俗称的“删库”就是删掉整个数据库，虽然实战中几乎不会用到，但作为新手经常手误，在练习阶段安全起见，最好还是专门创建一个 database 用于练手，练完直接删掉整个练习库：</p>
<figure><div class="code-wrapper"><pre class="language-SQL" data-language="SQL"><code class="language-SQL">DELETE DATABASE database_name;</code></pre></div></figure>

<p>如果简单总结下过去一个月，使用<code>mysql</code>的体验，那就是：除了<code>mysql</code> 的安装激活太麻烦，数据的增删改查比操作文本方便太多了！！完全值得容忍安装激活的麻烦。另外 <code>mysql</code> 常用语法确实简单、非常有规律。</p>
<p>希望我的总结带给你帮助。鼓励我继续分享，那就请点个赞吧！</p>

            </div>

            
                <div class="post-copyright-info">
                    
<div class="article-copyright-info-container">
    <ul class="copyright-info-content">
        <li class="post-title">
            <span class="type">Post title</span>: <span class="content">Python如何与MySQL实现交互及常用sql语句</span>
        </li>
        <li class="post-author">
            <span class="type">Post author</span>: <span class="content">Marsh</span>
        </li>
        <li class="post-time">
            <span class="type">Create time</span>: <span class="content">2022-11-12 16:45:09</span>
        </li>
        <li class="post-link">
            <span class="type">Post link</span>: <span class="content">2022/11/12/python连接MySQL/</span>
        </li>
        <li class="post-license">
            <span class="type">Copyright notice</span>: <span class="content">All articles in this blog are licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> unless stating additionally.</span>
        </li>
    </ul>
    <div class="copy-copyright-info flex-center tooltip" data-content="Copy copyright info" data-offset-y="-2px">
        <i class="fa-solid fa-copy"></i>
    </div>
</div>

                </div>
            

            
                <ul class="post-tags-box">
                    
                        <li class="tag-item">
                            <a href="../../../../tags/%E8%BD%AC%E8%BD%BD/">#转载</a>&nbsp;
                        </li>
                    
                        <li class="tag-item">
                            <a href="../../../../tags/Python/">#Python</a>&nbsp;
                        </li>
                    
                        <li class="tag-item">
                            <a href="../../../../tags/MySQL/">#MySQL</a>&nbsp;
                        </li>
                    
                </ul>
            

            
                <div class="article-nav">
                    
                        <div class="article-prev">
                            <a class="prev"
                               rel="prev"
                               href="../Markdown%E8%AF%AD%E6%B3%95/"
                            >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                                <span class="title flex-center">
                                <span class="post-nav-title-item">Markdown语法</span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                            </a>
                        </div>
                    
                    
                        <div class="article-next">
                            <a class="next"
                               rel="next"
                               href="../../11/%E5%A6%82%E4%BD%95%E8%AE%A9SQL%E6%8F%90%E9%AB%98%E4%B8%80%E4%B8%AA%E5%8F%B0%E9%98%B6%EF%BC%9F/"
                            >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">如何让SQL提高一个台阶？</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                                <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                            </a>
                        </div>
                    
                </div>
            

            
                <div class="comment-container">
                    
<div class="comments-container">
    <div id="comments-anchor"></div>
    <div class="comment-area-title">
        <i class="fas fa-comments"></i>&nbsp;Comments
    </div>
    
        
            

    <div class="gitalk-comment-container">
        <div id="gitalk-container"></div>
        <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk/dist/gitalk.css">
        <script data-pjax src="//cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js"></script>
        <script data-pjax>
          function loadGitalk() {
            let __gitalk__pathname = decodeURI(location.pathname);
            const __gitalk__pathnameLength = __gitalk__pathname.length;
            const __gitalk__pathnameMaxLength = 50;
            if (__gitalk__pathnameLength > __gitalk__pathnameMaxLength) {
              __gitalk__pathname = __gitalk__pathname.substring(0, __gitalk__pathnameMaxLength - 3) + '...';
            }

            try {
              Gitalk && new Gitalk({
                clientID: 'ab165842dc9a64de37e9# GitHub Application Client ID',
                clientSecret: '96d2589a9e0310efa2bf996a5f5e88ef8b7b3557#',
                repo: 'hexo-site-coments',
                owner: 'jaling9',
                admin: 'jaling9',
                id: __gitalk__pathname,
                proxy: '',
                language: 'en'
              }).render('gitalk-container');
            } catch (e) {
              window.Gitalk = null;
            }
          }

          if ('true' === 'true') {
            const loadGitalkTimeout = setTimeout(() => {
              loadGitalk();
              clearTimeout(loadGitalkTimeout);
            }, 1000);
          } else {
            window.addEventListener('DOMContentLoaded', loadGitalk);
          }
        </script>
    </div>



        
    
</div>

                </div>
            
        </div>

        
            <div class="toc-content-container">
                <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E5%BB%BA%E7%AB%8B%E8%BF%9E%E6%8E%A5%E4%B8%8E%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92"><span class="nav-text">一、建立连接与数据交互</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%83%85%E5%A2%83A%EF%BC%9Apython-%E6%BC%94%E7%AE%97%E5%BE%97%E5%87%BA%E6%95%B0%E6%8D%AE%EF%BC%8C%E6%83%B3%E8%A6%81%E5%86%99%E5%85%A5%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-text">情境A：python 演算得出数据，想要写入数据库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%83%85%E5%A2%83B%EF%BC%9Apython-%E8%84%9A%E6%9C%AC%E6%83%B3%E4%BB%8E-mysql-%E6%8B%BF%E5%88%B0%E6%95%B0%E6%8D%AE"><span class="nav-text">情境B：python 脚本想从 mysql 拿到数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%83%85%E5%A2%83C%EF%BC%9Apython-%E8%84%9A%E6%9C%AC%E5%8D%95%E6%96%B9%E9%9D%A2%E5%90%91-mysql-%E5%8F%91%E5%87%BA%E6%8C%87%E4%BB%A4%EF%BC%8C%E6%97%A0%E9%9C%80%E6%8B%BF%E5%88%B0%E6%95%B0%E6%8D%AE"><span class="nav-text">情境C：python 脚本单方面向 mysql 发出指令，无需拿到数据</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81sql%E8%AF%AD%E5%8F%A5%EF%BC%9A%E6%90%9C%E7%B4%A2%E6%9F%A5%E8%AF%A2"><span class="nav-text">二、sql语句：搜索查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%98%E9%87%8FA%EF%BC%9A%E8%8C%83%E5%9B%B4%EF%BC%8C%E6%98%AF%E6%8C%87%E8%BF%94%E5%9B%9E%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%E7%9A%84%E8%8C%83%E5%9B%B4%E3%80%82"><span class="nav-text">变量A：范围，是指返回查询结果的范围。</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%98%E9%87%8FB%EF%BC%9A%E6%9D%A1%E4%BB%B6%E6%98%AF%E6%8C%87%EF%BC%8C%E6%9C%9F%E6%9C%9B%E8%BF%94%E5%9B%9E%E7%9A%84%E6%95%B0%E6%8D%AE%E6%BB%A1%E8%B6%B3%E5%93%AA%E4%BA%9B%E6%9D%A1%E4%BB%B6%E3%80%82"><span class="nav-text">变量B：条件是指，期望返回的数据满足哪些条件。</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E3%80%81sql%E8%AF%AD%E5%8F%A5%EF%BC%9A%E4%BF%AE%E6%94%B9%E8%A1%A8%E5%B1%9E%E6%80%A7"><span class="nav-text">三、sql语句：修改表属性</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%83%85%E5%A2%83A%EF%BC%9A%E6%96%B0%E5%A2%9E%E4%B8%80%E5%88%97%E3%80%82%E5%85%B3%E9%94%AE%E8%AF%8D-ADD"><span class="nav-text">情境A：新增一列。关键词 ADD</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%83%85%E5%A2%83B%EF%BC%9A%E4%BF%AE%E6%94%B9%E6%9F%90%E5%88%97%E7%9A%84%E5%90%8D%E7%A7%B0%E3%80%82%E5%85%B3%E9%94%AE%E8%AF%8D-CHANGE"><span class="nav-text">情境B：修改某列的名称。关键词 CHANGE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%83%85%E5%A2%83C%EF%BC%9A%E4%BF%AE%E6%94%B9%E6%9F%90%E5%88%97%E7%9A%84%E5%B1%9E%E6%80%A7%E3%80%82%E5%85%B3%E9%94%AE%E8%AF%8D%E6%98%AF-MODIFY"><span class="nav-text">情境C：修改某列的属性。关键词是 MODIFY</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9B%E3%80%81sql%E8%AF%AD%E5%8F%A5%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%9A%84%E5%A2%9E%E6%94%B9%E5%88%A0"><span class="nav-text">四、sql语句：数据的增改删</span></a></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            
<footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
                <span>2020</span> -
            
            2023
            
                &nbsp;<i class="fas fa-heart icon-animate"></i>
                &nbsp;<a href="/">Marsh</a>
            
        </div>
        
            <script async data-pjax
                    src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    Visitor Count&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                
                
                    Totalview&nbsp;<span id="busuanzi_value_site_pv"></span>
                
            </div>
        
        <div class="theme-info info-item">
            Powered by <a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;|&nbsp;Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.6.1</a>
        </div>
        
        
            <div class="deploy-info info-item">
                
                    This site is provided with deployment services by <span class="tooltip" data-content="GitHub Pages"><img src="/images/deploy-provider/github.png"></span>
                
            </div>
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="tools-item flex-center go-to-comments">
                <i class="fas fa-comment"></i>
                <span class="post-comments-count"></span>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/dark-light-toggle.js"></script>




    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/local-search.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/code-block.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/lazyload.js"></script>


<div class="post-scripts pjax">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/post-helper.js"></script>
        
            <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/libs/anime.min.js"></script>
        
        
            <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/toc.js"></script>
        
    
</div>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
