<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Marsh的博客">
    <meta name="author" content="Marsh">
    
    <title>
        
            PyEcharts学习总结 |
        
        Marsh&#39;s blog
    </title>
    
<link rel="stylesheet" href="../css/style.css">

    <link rel="shortcut icon" href="../../../../images/marsh.jpeg">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/fontawesome.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/regular.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/solid.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/brands.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"en","path":"search.json"}
    KEEP.theme_config = {"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true},"style":{"primary_color":"#c0392b","logo":"/images/marsh.jpeg","favicon":"/images/marsh.jpeg","avatar":"/images/marsh.jpeg","font_size":"16px","font_family":null,"hover":{"shadow":true,"scale":true},"first_screen":{"enable":true,"header_transparent":true,"background_img":"/images/bg.svg","description":"Keep writing and Keep loving.","font_color":null,"hitokoto":true},"scroll":{"progress_bar":true,"percent":true}},"local_search":{"enable":true,"preload":true},"code_copy":{},"code_block":{"tools":{"enable":true,"style":"default"},"highlight_theme":"default"},"side_tools":{},"pjax":{"enable":true},"lazyload":{"enable":true},"comment":{"enable":true,"use":"gitalk","valine":{"appId":"JThobepyUWZ8wrCKpWzo5Vju-gzGzoHsz","appKey":"5l7p5rk6oXtEIST5bExEAMrT","server_urls":null,"placeholder":"留下点足迹~# Input box placeholder"},"gitalk":{"github_id":"jaling9","github_admins":"jaling9","repository":"hexo-site-coments","client_id":"ab165842dc9a64de37e9","client_secret":"96d2589a9e0310efa2bf996a5f5e88ef8b7b3557#","proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.8"},"waline":{"server_url":null,"reaction":false,"version":2}},"post":{"author_label":{"enable":true,"auto":false,"custom_label_list":["摸不到门","半只脚入门","摸不到门"]},"word_count":{"enable":true,"wordcount":true,"min2read":true},"img_align":"left","copyright_info":true},"version":"3.6.1"}
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"}
    KEEP.language_code_block = {"copy":"Copy code","copied":"Copied","fold":"Fold code block","folded":"Folded"}
    KEEP.language_copy_copyright = {"copy":"Copy copyright info","copied":"Copied","title":"Original article title","author":"Original article author","link":"Original article link"}
  </script>
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <i class="pjax-progress-icon fas fa-circle-notch fa-spin"></i>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
                <a class="logo-image" href="/">
                    <img src="../../../../images/marsh.jpeg">
                </a>
            
            <a class="logo-title" href="/">
               Marsh&#39;s blog
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="../../../../index.html"
                            >
                                HOME
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="../../../../archives"
                            >
                                ARCHIVES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="../../../../tags"
                            >
                                TAGS
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="../../../../categories"
                            >
                                CATEGORIES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="../../../../about"
                            >
                                ABOUT
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="../../../../index.html">HOME</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="../../../../archives">ARCHIVES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="../../../../tags">TAGS</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="../../../../categories">CATEGORIES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="../../../../about">ABOUT</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="post-page-container">
        <div class="article-content-container">

            <div class="article-title">
                <span class="title-hover-animation">PyEcharts学习总结</span>
            </div>

            
                <div class="article-header">
                    <div class="avatar">
                        <img src="../../../../images/marsh.jpeg">
                    </div>
                    <div class="info">
                        <div class="author">
                            <span class="name">Marsh</span>
                            
                                <span class="author-label">摸不到门</span>
                            
                        </div>
                        <div class="meta-info">
                            
<div class="article-meta-info">
    <span class="article-date article-meta-item">
        
            <i class="fa-regular fa-calendar-plus"></i>&nbsp;
        
        <span class="pc">2022-11-13 00:12:17</span>
        <span class="mobile">2022-11-13 00:12</span>
    </span>
    
        <span class="article-update-date article-meta-item">
        <i class="fas fa-file-pen"></i>&nbsp;
        <span class="pc">2022-11-18 23:30:03</span>
    </span>
    
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="../../../../categories/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">数据分析</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="../../../../tags/%E5%8E%9F%E5%88%9B/">原创</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="../../../../tags/Python/">Python</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>6.9k Words</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>27 Mins</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                        </div>
                    </div>
                </div>
            

            <div class="article-content keep-markdown-body">
                

                <blockquote>
<p>pyecharts 分为 <code>v0.5.x</code> 和 <code>v1.0.0+</code> 两个版本，这篇总结针对新版本。</p>
</blockquote>
<blockquote>
<p>本文不包含基础例子的演示，主要记录一些细节方面的理解。简介中推荐的网站有相关示例。</p>
</blockquote>
<h2 id="一、简介-–-Echarts-amp-PyEcharts"><a href="#一、简介-–-Echarts-amp-PyEcharts" class="headerlink" title="一、简介 – Echarts &amp; PyEcharts"></a>一、简介 – Echarts &amp; PyEcharts</h2><p><a target="_blank" rel="noopener" href="https://github.com/apache/echarts">Echarts</a> 是一个基于 JavaScript 的图表库，用于在 HTML 中生成可交互的图表。关于更多 js 图表库可以参考 CSDN 上的 <a target="_blank" rel="noopener" href="https://blog.csdn.net/Pokemogo/article/details/78864664">这篇博客</a>。<a target="_blank" rel="noopener" href="https://github.com/pyecharts/pyecharts">PyEcharts</a> 旨在提供在 Python 中使用 Echarts 的 API，以便将数据可视化的流程整合到 Python 数据处理的流程当中。</p>
<p><strong>以下是四个文档和示例网站，各有特点。利用好这几个网站基本上就可以解决所有可能遇到的问题，而不需要在搜索引擎中漫无目的地翻查。</strong>（喜欢这篇文章的新手朋友，建议先撸一遍下面 gallery.pyecharts.org 里面的代码再来看，因为文章写得不好，入门者很可能一头雾水）</p>
<ul>
<li><strong>Echarts</strong><ul>
<li><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/echarts_tutorial">https://www.w3cschool.cn/echarts_tutorial</a> （配置项的文档非常详尽）</li>
<li><a target="_blank" rel="noopener" href="https://echarts.apache.org/zh/index.html">https://echarts.apache.org/zh/index.html</a> （<a target="_blank" rel="noopener" href="https://echarts.apache.org/examples/zh/index.html">示例</a>中有很多出色的可视化例子）</li>
</ul>
</li>
<li><strong>PyEcharts</strong><ul>
<li><a target="_blank" rel="noopener" href="https://pyecharts.org/#/zh-cn/intro">https://pyecharts.org/#/zh-cn/intro</a> （PyEcharts 的 API 文档）</li>
<li><a target="_blank" rel="noopener" href="https://gallery.pyecharts.org/#/README">https://gallery.pyecharts.org/#/README</a> （PyEcharts 绘图的示例和代码）</li>
</ul>
</li>
</ul>
<h3 id="Echarts"><a href="#Echarts" class="headerlink" title="Echarts"></a>Echarts</h3><p>首先通过一个简单的例子了解 Echarts 的工作方式，注意到使用 Echarts 需要 HTML 语言基础，进阶则需要 js 和 css 的基础。（如果只是在 Python 中进行可视化，对前面三件套的要求不高，基本上看看例子就能摸索出来写法，编程语言都是共通的。）</p>
<figure><div class="code-wrapper"><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>MyCharts<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
  <span class="token comment">&lt;!-- 引入echarts.js 很多cdn源都可以引用 视情况使用 --></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/echarts@latest/dist/echarts.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
  <span class="token comment">&lt;!-- 图表容器--整个网页就是一个div 内容都是通过echarts.min.js渲染出来的 --></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>main<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 600px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span>400px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token comment">&lt;!-- 图表渲染的js代码 --></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
      <span class="token comment">// 初始化echarts实例</span>
      <span class="token keyword">var</span> myChart <span class="token operator">=</span> echarts<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'main'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 指定图表的配置项和数据</span>
      <span class="token keyword">var</span> option <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
          <span class="token comment">// option变量的内容是一个js对象类型(Object) 类似python中的字典类型</span>
          <span class="token comment">// option对象的属性(Attribute)可以赋值为各种js基本类型 包括对象类型</span>
          <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">'ECharts 入门示例'</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token comment">// 图表标题选项</span>
          <span class="token literal-property property">tooltip</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>                      <span class="token comment">// 工具提示选项</span>
          <span class="token literal-property property">legend</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'销量'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>          <span class="token comment">// 图例选项</span>
          <span class="token literal-property property">xAxis</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"衬衫"</span><span class="token punctuation">,</span><span class="token string">"羊毛衫"</span><span class="token punctuation">,</span><span class="token string">"雪纺衫"</span><span class="token punctuation">,</span><span class="token string">"裤子"</span><span class="token punctuation">,</span><span class="token string">"高跟鞋"</span><span class="token punctuation">,</span><span class="token string">"袜子"</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">yAxis</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token comment">// 缺省时没有标注</span>
          <span class="token literal-property property">series</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span>  <span class="token comment">// series就是图表主体部分用到的数据</span>
              <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'销量'</span><span class="token punctuation">,</span>   <span class="token comment">// name参数用于区分多个series</span>
              <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'bar'</span><span class="token punctuation">,</span>    <span class="token comment">// 图表类型 可以是line,scatter等</span>
              <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">]</span> <span class="token comment">// 图表主体的数据 这里就是bar的长度</span>
          <span class="token punctuation">&#125;</span><span class="token punctuation">]</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
      <span class="token comment">// 使用刚指定的配置项和数据显示图表。</span>
      myChart<span class="token punctuation">.</span><span class="token function">setOption</span><span class="token punctuation">(</span>option<span class="token punctuation">)</span><span class="token punctuation">;</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre></div></figure>

<p><img src="https://paradiseeee.github.io/post-assets/20201221/basic.png"></p>
<p>将上述代码保存为 html 文件在浏览器打开就可以看到图表了（左图），如果直接将 <code>&lt;head&gt;</code> 中引用的 js 文件保存到本地，将引用链接改为本地文件链接，那么无网络的情况下也可以显示。清楚了原理很容易就可以画出自己想要的图表，比如将上述代码中 <code>option.series[0].type</code> 的值改为 <code>line</code>，条形图就变成折线图了（右图）。将 <code>option.series[0].data</code> 中的数据改为自己的数据，就可以可视化自己的数据了。</p>
<h3 id="PyEcharts"><a href="#PyEcharts" class="headerlink" title="PyEcharts"></a>PyEcharts</h3><p>但是在实际的数据可视化中，我们的数据可能要成千上万行，绘制的图表也有很多个，不可能手动复制粘贴去修改，这时候就需要用到 pyecharts 了。首先通过 <code>pip install pyecharts --upgrade</code> 安装或更新到最新版。绘制以上同样的图表，只需要以下的代码：</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># 引入子模块</span>
<span class="token keyword">from</span> pyecharts <span class="token keyword">import</span> charts <span class="token keyword">as</span> pyc
<span class="token keyword">from</span> pyecharts <span class="token keyword">import</span> options <span class="token keyword">as</span> opts
<span class="token comment"># 这里链式调用，也可以先实例化一个 charts 对象再一步步设置</span>
bar <span class="token operator">=</span> <span class="token punctuation">(</span>
    <span class="token comment"># 实例化：</span>
    pyc<span class="token punctuation">.</span>Bar<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 对应上面html文档中的 option.XAxis.data：</span>
    <span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"衬衫"</span><span class="token punctuation">,</span> <span class="token string">"羊毛衫"</span><span class="token punctuation">,</span> <span class="token string">"雪纺衫"</span><span class="token punctuation">,</span> <span class="token string">"裤子"</span><span class="token punctuation">,</span> <span class="token string">"高跟鞋"</span><span class="token punctuation">,</span> <span class="token string">"袜子"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># 对应上面html文档中的 option.series：</span>
    <span class="token comment"># 注意到 option.series 是js数组类型，也就是可以添加多个序列</span>
    <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">"销量"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
    <span class="token comment"># global_opts 对应上面html文档中的 option 的属性</span>
    <span class="token comment"># 例如 option.title 通过 title_opts 参数设置</span>
    <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"Echarts 入门示例"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token comment"># 在当前目录生成默认名称为 render.html 的文档</span>
bar<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div></figure>

<p>通过这个例子就可以理解，pyecharts 就是通过 python 代码设置 js 代码里面的变量，然后生成 html 文档。生成的 html 文档不同的是 pyecharts 会把缺省的参数自动填充默认值，所以生成的 html 代码会比上面自己写的长很多。从这里也可以明白为什么说使用 pyecharts 要使用开始介绍的两个 echarts 的网站，因为参数都是对应的。<strong>pyecharts 文档中没查到的参数设置，可以到 echarts 的教程上面查找。</strong></p>
<h2 id="二、常用图表"><a href="#二、常用图表" class="headerlink" title="二、常用图表"></a>二、常用图表</h2><p>pyecharts 整个项目结构见下图。绘图时用到的所有类都在 <code>pyecharts.charts</code> 子模块中，<code>pyecharts.charts</code> 中所有的图表类都直接或间接继承于 <code>pycharts.Base</code> 类。由于图表类型不同，中间又有不同图表类型的子类，如直角坐标系图表类、 3D 图表类、极坐标图表类，等。相同图表类型的图表绘图方法高度一致，在文章开始介绍的两个 pyecharts 网站中可以找到 API 文档和图表示例代码，比较简单，这里就不做示例了。</p>
<p><img src="https://paradiseeee.github.io/post-assets/20201221/tree.png"></p>
<h2 id="三、选项配置"><a href="#三、选项配置" class="headerlink" title="三、选项配置"></a>三、选项配置</h2><p>选项配置主要是 set_global_opts 和 set_series_opts 两个方法，顾名思义前者设置的是对应的 js 代码中 <code>option</code> 变量的属性，后者设置的对应的 js 代码中 <code>option.series</code> 的属性。</p>
<h3 id="常用-options"><a href="#常用-options" class="headerlink" title="常用 options"></a>常用 options</h3><p>常用的 options 分为四类，对应一般绘图时的四个步骤，注意不是所有图表类的对应方法都通用，在 pyecharts.org 中参考对应方法的文档使用，或者在 ipython 中使用魔术命令： <code>Bar.set_global_opts?</code>、<code>opts.ItemStyleOpts?</code> 等查看对应参数和用法。另外这些 options 是层层嵌套的，比如在 <code>opts.AxisOpts</code> 里面，又有用到 <code>opts.LabelOpts</code> 来定义坐标轴标签的样式，这里就不深挖了，只列举第一层的常用选项。</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># 图表类的 init_opts，设置图表整体风格，大小等</span>
<span class="token keyword">from</span> pyecharts <span class="token keyword">import</span> <span class="token builtin">globals</span> <span class="token keyword">as</span> glbs
Bar<span class="token punctuation">(</span>init_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>InitOpts<span class="token punctuation">(</span>
    glbs<span class="token punctuation">.</span>ThemeType<span class="token punctuation">.</span>DARK<span class="token punctuation">,</span> bg_color<span class="token operator">=</span><span class="token string">'#1a1c1d'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token string">'100%'</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token string">'400px'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div></figure>

<figure><div class="code-wrapper"><pre class="language-javascript" data-language="javascript"><code class="language-javascript"># 使用 add 方法（泛指 add_yaxis<span class="token punctuation">,</span> add_schema 等）时的 options
itemstyle_opts <span class="token operator">=</span> opts<span class="token punctuation">.</span><span class="token function">ItemStyleOpts</span><span class="token punctuation">(</span><span class="token punctuation">)</span>           # 元素样式，如散点图的点
emphasis_itemstyle_opts <span class="token operator">=</span> opts<span class="token punctuation">.</span><span class="token function">ItemStyleOpts</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  # 元素高亮样式
linestyle_opts <span class="token operator">=</span> opts<span class="token punctuation">.</span><span class="token function">LineStyleOpts</span><span class="token punctuation">(</span><span class="token punctuation">)</span>           # 用于 Line<span class="token punctuation">.</span>add_yaxis 里面</code></pre></div></figure>

<figure><div class="code-wrapper"><pre class="language-javascript" data-language="javascript"><code class="language-javascript"># set_series_opts 中的 options
tooltip_opts <span class="token operator">=</span> opts<span class="token punctuation">.</span><span class="token function">TooltipOpts</span><span class="token punctuation">(</span><span class="token punctuation">)</span>       # 工具提示
itemstyle_opts <span class="token operator">=</span> opts<span class="token punctuation">.</span><span class="token function">ItemStyleOpts</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   # 元素样式
label_opts <span class="token operator">=</span> opts<span class="token punctuation">.</span><span class="token function">LabelOpts</span><span class="token punctuation">(</span><span class="token punctuation">)</span>           # 标签样式，例如条形图顶部显示的数值
areastyle_opts <span class="token operator">=</span> opts<span class="token punctuation">.</span><span class="token function">AreaStyleOpts</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   # 区域样式，例如线形图与坐标轴围成的区域</code></pre></div></figure>

<figure><div class="code-wrapper"><pre class="language-none"><code class="language-none"># set_global_opts 中的 options
title_opts &#x3D; opts.TitleOpts()           # 标题、副标题及其字体颜色等样式
xaxis_opts &#x3D; opts.AxisOpts()            # 坐标轴的样式，如轴线样式，文字旋转等
yaxis_opts &#x3D; opts.AxisOpts()            # 同上
datazoom_opts &#x3D; opts.DataZoomOpts()     # 数据过多时可以使用类似滚动条的插件
legend_opts &#x3D; opts.LegendOpts()         # 图例是否显示、样式及其位置等
visualmap_opts &#x3D; opts.VisualMapOpts()   # 视觉映射，例如按系列值的大小给元素着色
toolbox_opts &#x3D; opts.ToolboxOpts()       # 在图中加入放大缩小，导出图片等工具按钮
graphic_opts &#x3D; [opts.GraphicGroup]      # 加入自定义的图形，如多边形，水印等内容</code></pre></div></figure>

<h3 id="经验总结"><a href="#经验总结" class="headerlink" title="经验总结"></a>经验总结</h3><p>要注意到 <code>pyecharts.options</code> 这个类，上述的两个方法的参数都是赋值为 <code>pyecharts.options</code> 的子类，例如 <code>pyecharts.options.AxisOpts</code>、<code>pyecharts.options.LabelOpts</code>，等。除了使用 options 的子类，还可以直接使用字典（如前文所述，Python 中的字典就相当于 js 的对象，把对应的字典传给对应的属性对象就可以了）。例如</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">Line<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
    legend_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LegendOpts<span class="token punctuation">(</span>is_show<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span></code></pre></div></figure>

<p>可以写为：</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">Line<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
    legend_opts<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'show'</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">)</span></code></pre></div></figure>

<p>注意到这里也不是严格对应的，比如在 options 类的参数中是 <code>is_show</code>，在字典中的键是 <code>show</code>。个人觉得这是 pyecharts 的一个不足的地方，主要是因为这是一个 Python 的项目，它得默认使用者不懂 js，于是只能弄一堆的 options 对象（pyecharts.options 里面有大约 100 个 <code>***Opts</code> 对象）和一堆的 init 参数，虽然是很好地 “Python 化” 了，但是也搞到 API 十分的复杂，难记。如果在某些地方适当地使用 js 里面的内容，那整个逻辑会简化很多。可以看到文章一开始使用 echarts 绘图的时候就是一个很简单的逻辑。</p>
<p>另外这些 options 并不是全在上述两个方法中使用，比如 <code>add_yaxis</code> 中也有很多 options 参数，感觉有点混乱。而且也不是所有图表通用的，只能说是在大部分图表中通用。例如</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">Scatter<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span>set_series_opts<span class="token punctuation">(</span>
    emphasis_itemstyle_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>ItemStyleOpts<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span></code></pre></div></figure>

<p>这段代码设置了散点图当鼠标悬停在某个点上时，该点的高亮颜色。在 Line、Bar 等很多图表中都适用，但是在地理图 Geo 的 set_series_opts 方法中没有这个参数。</p>
<p><strong>并且</strong>，尝试得多了，你可能会发现：</p>
<ul>
<li>在 echarts 中支持的属性，在 pyecharts 的 API 中不支持</li>
<li>在 pyecharts 中支持的参数，写到 html 中时被直接无视，也不报错</li>
<li>在 pyecharts 中不支持的参数，你给它直接写到 html 文档的 js 代码中时，它是有效的</li>
</ul>
<p>等等各种奇怪的问题，这也不知道是 pyecharts 不成熟的地方，还是我自己没理解透彻。<strong>总之说明了一个道理，如果想要精通 pyecharts，随心所欲地绘制各种图表，还是要从学习 echarts 入手。</strong></p>
<h2 id="四、进阶技巧"><a href="#四、进阶技巧" class="headerlink" title="四、进阶技巧"></a>四、进阶技巧</h2><p>基础的绘图例子都可以在文章开始的网站中找到示例代码，下面介绍一下一些比较有用的进阶技巧。</p>
<h3 id="更换-echarts-min-js-的引用源"><a href="#更换-echarts-min-js-的引用源" class="headerlink" title="更换 echarts.min.js 的引用源"></a>更换 echarts.min.js 的引用源</h3><p>pyecharts 默认的源是 <code>https://assets.pyecharts.org/assets/</code>，一般国内网络加载较慢，可以通过以下代码采用 CDN 加速。当然，也可以像简介部分提到的，将 echarts.min.js 保存到任意位置然后引用，比如 localhost。如果这样则要注意，有些图不仅仅会用到 echarts.min.js，还需要用到其他的 js 资源，例如地图、词云图等。</p>
<figure><div class="code-wrapper"><pre class="language-none"><code class="language-none">cdn &#x3D; &quot;https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;echarts@latest&#x2F;dist&#x2F;&quot;
pyecharts.globals.CurrentConfig.ONLINE_HOST &#x3D; cdn</code></pre></div></figure>

<h3 id="参数数据类型"><a href="#参数数据类型" class="headerlink" title="参数数据类型"></a>参数数据类型</h3><p>一般我们会使用 pandas 处理数据，然后绘图。这时候要注意 pandas 里面的数值型使用的不是内置类型，而是 numpy 的数据类型。而 echarts 是不认识 numpy 数据类型的，这时候会画一个空的没有数据的图，让人一脸懵。可以如下显式更改数据类型：</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">Scatter<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span>
    <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> df<span class="token punctuation">.</span>index<span class="token punctuation">]</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span>
    <span class="token punctuation">[</span><span class="token builtin">float</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">for</span> n <span class="token keyword">in</span> df<span class="token punctuation">[</span><span class="token string">'col'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span>
<span class="token comment"># 注意，以下写法是不行的</span>
<span class="token comment"># 虽然传递的参数是内置类型float，但是pandas还是会自作主张给你改成numpy.float64</span>
df<span class="token punctuation">[</span><span class="token string">'col'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">)</span></code></pre></div></figure>

<h3 id="遇到不支持或无效的参数怎么办"><a href="#遇到不支持或无效的参数怎么办" class="headerlink" title="遇到不支持或无效的参数怎么办"></a>遇到不支持或无效的参数怎么办</h3><p>遇到上一小节最后提到的那些问题，比如某些属性在 echarts 中有效，但是在 pyecharts 中没有对应参数或者无效，这种情况我们最直接的思路就是手动去改 html 里面 js 代码。还是以简介部分那个图为例，比如我想微调一下主图在整个画布中的位置（可能是出于想用 overlap 方法在主图上叠加其他图表等原因），在 echarts 中可以如下实现：</p>
<p><img src="https://paradiseeee.github.io/post-assets/20201221/grid-html.png"></p>
<p>通过 grid 属性定义主图左上角的坐标和右下角的坐标，坐标可以是相对值，也可以是数值表示的绝对值，单位是 css 中的 px。为了好理解，这里故意将位置调得夸张一点，实际上我们经常需要微调主图的位置来适应布局。但是在 pyecharts 的常用图表类里是不能直接设置这个 grid 属性的（反正我没找到）：</p>
<p><img src="https://paradiseeee.github.io/post-assets/20201221/grid-error.png"></p>
<p>可以看到 global options 没有该参数。series options 里面倒是有这个参数，但是设置的不是同一个东西了。唯一的可能就是使用 <code>pyecharts.charts.Grid</code> 这个图表类时才允许加入 grid 参数，如下图。但是 Grid 类和其他常用图表类（例如 Bar）直接继承的类是不一样的，所以用 Grid 类打包图表之后会导致很多原本支持的设置失效。</p>
<p><img src="https://paradiseeee.github.io/post-assets/20201221/grid.png"></p>
<p>对此一开始我想到一个很笨拙的办法：强行在 js 中写入属性，替代手动修改属性的过程。首先按照简介中的代码，生成一个 render.html，然后如下写入属性：</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">write_js</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> locate<span class="token punctuation">,</span> write<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        html <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>html<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>locate<span class="token punctuation">,</span> write<span class="token punctuation">)</span><span class="token punctuation">)</span> 

<span class="token comment"># locate 用于定位修改位置，这里建议使用 option 里面参数来定位</span>
<span class="token comment"># 比如这里准备写到 "title" 属性的前面：</span>
locate <span class="token operator">=</span> <span class="token string">'"title": [\n'</span> <span class="token comment"># 尽可能多的字符，否则可能定位错</span>
<span class="token comment"># 需要写入的属性</span>
write <span class="token operator">=</span> <span class="token string">'"grid": &#123;"x": "20%", "y": "30%", "x2": "30%", "y2": "20%"&#125;, \n'</span>
write_js<span class="token punctuation">(</span><span class="token string">'render.html'</span><span class="token punctuation">,</span> locate<span class="token punctuation">,</span> write<span class="token operator">+</span>locate<span class="token punctuation">)</span></code></pre></div></figure>

<p><img src="https://paradiseeee.github.io/post-assets/20201221/render.png"></p>
<p>好笨的方法，千万别学。后来经过进一步对 pycharts 图表类属性的研究，发现可以直接这样就搞定：</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># 首先绘图</span>
bar <span class="token operator">=</span> Bar<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token comment"># 然后还缺什么属性，直接往 options 里面添加，然后 render</span>
bar<span class="token punctuation">.</span>options<span class="token punctuation">[</span><span class="token string">'grid'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"x"</span><span class="token punctuation">:</span> <span class="token string">"20%"</span><span class="token punctuation">,</span> <span class="token string">"y"</span><span class="token punctuation">:</span> <span class="token string">"30%"</span><span class="token punctuation">,</span> <span class="token string">"x2"</span><span class="token punctuation">:</span> <span class="token string">"30%"</span><span class="token punctuation">,</span> <span class="token string">"y2"</span><span class="token punctuation">:</span> <span class="token string">"20%"</span><span class="token punctuation">&#125;</span>
bar<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 注意到 bar.options 是一个字典</span>
<span class="token comment"># 它的内容就是生成的 html 文档的 js 代码里面的 option 变量的内容</span></code></pre></div></figure>

<h3 id="运用-css-和-js-控制视觉效果"><a href="#运用-css-和-js-控制视觉效果" class="headerlink" title="运用 css 和 js 控制视觉效果"></a>运用 css 和 js 控制视觉效果</h3><p>如果想要随心所欲地自定义视觉效果，需要了解一些 css 的基础知识。如果仅仅使用 Python 代码，我们定义一个散点图中的散点的颜色时，可以这样写：</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">Scatter<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span>index_data<span class="token punctuation">)</span><span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span>
    series_name<span class="token punctuation">,</span> value_data<span class="token punctuation">,</span> itemstyle_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>ItemStyleOpts<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span></code></pre></div></figure>

<p>运用 css 代码，我们可以将 ItemStyleOpts 写成：</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">opts<span class="token punctuation">.</span>ItemStyleOpts<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token string">'#ff0000'</span><span class="token punctuation">)</span>
opts<span class="token punctuation">.</span>ItemStyleOpts<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token string">'rgba(255,0,0,1)'</span><span class="token punctuation">)</span></code></pre></div></figure>

<p>或者运用图表库提供的函数：</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pyecharts<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>utils <span class="token keyword">import</span> JsCode

opts<span class="token punctuation">.</span>ItemStyleOpts<span class="token punctuation">(</span>color<span class="token operator">=</span>JsCode<span class="token punctuation">(</span>
    <span class="token comment"># 引入echarts.min.js后就可以使用echarts库的方法</span>
    <span class="token triple-quoted-string string">''' new echarts.graphic.RadialGradient(
        0.5, 0.5, 0.5,  
        [&#123;offset: 0, color: 'rgba(255,0,0,1)'&#125;,
        &#123;offset: 1, color: 'rgba(0,0,255, 1)'&#125;]
    ) '''</span>
<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div></figure>

<p>直接在浏览器 console 中更改 option（还是简介中那个图），结果如下：</p>
<p><img src="https://paradiseeee.github.io/post-assets/20201221/css.png"></p>
<p>或者对于一些在 API 中为数值常量的参数，可以通过 js 变成变量。例如在散点图中定义点的大小，可以通过 js 使每个点显示不同大小：</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">Scatter<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span>
    series_name<span class="token punctuation">,</span> data_pair<span class="token punctuation">,</span>
    <span class="token comment"># 固定大小：symbol_size=5,</span>
    <span class="token comment"># 由数据值决定大小：</span>
    symbol_size<span class="token operator">=</span>JsCode<span class="token punctuation">(</span><span class="token string">'function (data) &#123;return data[1]*10;&#125;'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span></code></pre></div></figure>

<p>这里用到的 js 代码其实并不复杂，Python 混 Java 的感觉，学过上述两种的凭感觉都会写。感兴趣的可以学一下。</p>
<h3 id="运用-js-控制交互效果"><a href="#运用-js-控制交互效果" class="headerlink" title="运用 js 控制交互效果"></a>运用 js 控制交互效果</h3><p>这里经常用于改变工具提示（tooltip），就是鼠标悬停某个数据点时显示出来的东西。以之前做的一个图表为例，主要涉及的 option 如下：</p>
<p><img src="https://paradiseeee.github.io/post-assets/20201221/example-option.png"></p>
<p>默认情况下图表的工具提示格式是：<code>series_name \n x轴标签 y轴的值</code>，但是如果需要自定义格式，就要使用 js 回调函数。这个在 pyecharts.org 上也提到，但不是很详细。具体代码如下，参考上图给出的 option 就可以理解了。</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pyecharts<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>utils <span class="token keyword">import</span> JsCode
tooltipJS <span class="token operator">=</span> <span class="token triple-quoted-string string">'''
    function (param) &#123; 
        // param参数接收的就是上图中的option.series.data这个数组中对应的元素
        var line1 = 'name: ' + param.data[0] + '&lt;br/>';
        var line2 = 'value1: ' + param.data[1] + '&lt;br/>';
        var line3 = 'value2: ' + Math.ceil(10**param.data[2]); // 引用js内置函数
        return line1 + line2 + line3;   // return的内容就是到时工具提示显示的内容
    &#125;
'''</span>
<span class="token comment"># 然后通过 JsCode 传给 TooltipOpts 的 formatter</span>
Scatter<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
    tooltip_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TooltipOpts<span class="token punctuation">(</span>formatter<span class="token operator">=</span>JsCode<span class="token punctuation">(</span>tooltipJS<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span></code></pre></div></figure>

<p>那么问题来了，上图的数据部分是绘图时传给 series 的参数，但是如果我还想在 tooltip 里说点别的东西怎么办？可以在 <code>add_yaxis</code> 时<strong>强行</strong>传进去再使用 js 回调函数。以下是一个完整的绘图例子：</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pyecharts <span class="token keyword">import</span> charts <span class="token keyword">as</span> pyc
<span class="token keyword">from</span> pyecharts <span class="token keyword">import</span> options <span class="token keyword">as</span> opts
<span class="token keyword">from</span> pyecharts <span class="token keyword">import</span> <span class="token builtin">globals</span> <span class="token keyword">as</span> glbs
bar <span class="token operator">=</span> pyc<span class="token punctuation">.</span>Bar<span class="token punctuation">(</span>
    init_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>InitOpts<span class="token punctuation">(</span>theme<span class="token operator">=</span>glbs<span class="token punctuation">.</span>ThemeType<span class="token punctuation">.</span>DARK<span class="token punctuation">,</span> bg_color<span class="token operator">=</span><span class="token string">'#1a1c1d'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span>
    <span class="token string">'test charts'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span>
bar<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div></figure>

<p><img src="https://paradiseeee.github.io/post-assets/20201221/tooltipjs.png"></p>
<p>如上图，这时是默认的工具提示格式，但是如果我想让它不显示为数值 <code>[1, 2, 3]</code>，而是描述性的信息，例如 <code>[&#39;低&#39;, &#39;中&#39;, &#39;高&#39;]</code> 或者更丰富的信息，那可以这样写：</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">bar <span class="token operator">=</span> pyc<span class="token punctuation">.</span>Bar<span class="token punctuation">(</span>
    init_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>InitOpts<span class="token punctuation">(</span>theme<span class="token operator">=</span>glbs<span class="token punctuation">.</span>ThemeType<span class="token punctuation">.</span>DARK<span class="token punctuation">,</span> bg_color<span class="token operator">=</span><span class="token string">'#1a1c1d'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span>
    <span class="token string">'test charts'</span><span class="token punctuation">,</span> 
    <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'低'</span><span class="token punctuation">,</span><span class="token string">'更多信息'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'中'</span><span class="token punctuation">,</span><span class="token string">'更多信息'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'高'</span><span class="token punctuation">,</span><span class="token string">'更多信息'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token comment"># 通过元组列表强行传进更多的信息</span>
    <span class="token comment"># 元组第一位是对应 xaxis 的序号，第二位是序列的值 这里就是bar的长度</span>
    <span class="token comment"># 剩下的爱加多少加多少，每个点写一篇800字作文都行</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
    tooltip_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TooltipOpts<span class="token punctuation">(</span>formatter<span class="token operator">=</span>JsCode<span class="token punctuation">(</span>
        <span class="token triple-quoted-string string">'''
        function (param) &#123;
            var line1 = 'index: ' + param.data[0] + '&lt;br/>';
            var line2 = 'value: ' + param.data[1] + '&lt;br/>';
            var line3 = 'info1: ' + param.data[2] + '&lt;br/>';
            var line4 = 'info2: ' + param.data[3];
            return line1 + line2 + line3 + line4;
        &#125;
        '''</span>
    <span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
bar<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div></figure>

<p>结果如下。如果没看懂这段代码，可以将 html 源码 render 出来，对应着看，自然就理解了。</p>
<p><img src="https://paradiseeee.github.io/post-assets/20201221/tooltipjs2.png"></p>
<p><strong>再进一步深入</strong>，以上方法也不是万能的。例如在特别的图表中，根本就没有 <code>add_yaxis</code> 方法。比如 <code>Geo</code> 图表类型，是通过 <code>add</code> 方法传入 series 数据，于是传参的格式跟上面方法又不同。这时可以通过以下代码传入主图以外的数据，以作 tooltip 等其他用途：</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">Geo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_schema<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_coordinate<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add<span class="token punctuation">(</span>
    series_name<span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token comment"># 这里传入的数据也是一个元组列表，但是它仅限两位的元组</span>
    <span class="token comment"># 第一位是地图中区域的名称，也就是到时会在地图中 A, B, C 三个地点标上散点</span>
    <span class="token comment"># 第一位在 js 中通过 param.data.name 引用</span>
    <span class="token comment"># 第二位是包含额外数据的列表，通过 param.data.value(一个js数组) 引用</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
    tooltip_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TooltipOpts<span class="token punctuation">(</span>formatter<span class="token operator">=</span>JsCode<span class="token punctuation">(</span>
        <span class="token triple-quoted-string string">'''
        function (param) &#123;
            return param.data.name + ' | ' +
                'info1:' + param.data.value[0] + 
                ', info2:' + param.data.value[1] + 
                ', info3:' + param.data.value[2];
        &#125;
        '''</span>
        <span class="token comment"># 当鼠标悬停在 B 点时，返回“B | info1: 4, info2: 5, info3: 6”</span>
    <span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span></code></pre></div></figure>

<p><strong>更复杂的情况是</strong>，加上额外数据后格式就是不对，或者会影响图表的其他组件。比如在上例的 <code>set_global_opts</code> 中加入了 visualmap 组件时，直接传入额外数据会导致 visualmap 显示不正常。这里我没有找到好的办法，所以想了一个_投机取巧_的方法。就是由于 python 字典跟 js 对象的格式是一样的，可以直接生成个字典的字符串写入 js ，然后再引用。于是上例可以写成：</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">data_pair <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">]</span> 
<span class="token comment"># 上面的 10, 100, 1000 就是用在 visualmap 中的数据值</span>
<span class="token comment"># 下面的则是用于 tooltip 的额外数据</span>
extend_data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'A'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span>
tooltip_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token string">'name'</span><span class="token punctuation">:</span> k<span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">:</span> v<span class="token punctuation">&#125;</span> <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> extend_data<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token comment"># 返回 tooltips 的函数</span>
tooltipjs <span class="token operator">=</span> <span class="token triple-quoted-string string">r'''
    function (param) &#123;
        var tooltip_data = __MARKER__; // 到时在 __MARKER__ 这里写入要传的数据
        for (int i=0; i&lt;tooltip_data.length; i++) &#123;         // 遍历
            if (param.data.name == tooltip_data[i].name) &#123;  // 匹配
                var values = tooltip_data[i].value;         // 提取额外数据
            &#125;
        &#125;
        // 返回给 tooltips
        return param.data.name + ' | ' +
            'info1:'+values[0]+', info2:'+values[1]+', info3:'+values[2];
    &#125;
'''</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'__MARKER__'</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>tooltip_data<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># 在这里加入了额外的数据</span>
<span class="token comment"># 绘图</span>
Geo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_schema<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_coordinate<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add<span class="token punctuation">(</span>
    series_name<span class="token punctuation">,</span> data_pair
<span class="token punctuation">)</span><span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
    tooltip_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TooltipOpts<span class="token punctuation">(</span>formatter<span class="token operator">=</span>Jscode<span class="token punctuation">(</span>tooltipjs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    visualmap_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>VisualMapOpts<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token comment"># 可以看到在调用 pyecharts 绘图时没有用到额外的数据，只有 data_pair</span>
<span class="token comment"># 用于 tooltip 的数据是写在 js 字符串里偷偷传进去的</span>
<span class="token comment"># 这时 tooltip 的效果跟上例一样，但是上例的写法不支持 visualmap</span></code></pre></div></figure>

<p>到这基本就到头了，因为上面的方法虽然很繁琐，但是基本可以所向披靡，对任何的图都通用。并且除了 tooltips，其他的数据交互的问题也可以按类似的思路来解决。</p>
<h2 id="五、总结"><a href="#五、总结" class="headerlink" title="五、总结"></a>五、总结</h2><h3 id="整体思路"><a href="#整体思路" class="headerlink" title="整体思路"></a>整体思路</h3><p>回到开始的问题：如何用 pyecharts 绘制一切你想象得到的交互式图表？根据前文的内容可以总结以下的流程：</p>
<ul>
<li>1） 根据需求，确定图表类型、基本内容、风格样式等</li>
<li>2） 粗略画个草图，如果不会画就上 gallery.pyechart.org 上抄个类似的</li>
<li>3） 通过各种 options 修改图中的细节部分，详细的文档在 pyecharts.org 上</li>
<li>4） 实在找不到的设置，在简介提到的 Echarts 网站中找配置，再写进 options 字典里</li>
<li>5） 跟据前面提到的技巧及其思路，修改还不符合要求的地方</li>
</ul>
<h3 id="实例验证"><a href="#实例验证" class="headerlink" title="实例验证"></a>实例验证</h3><p>最后用一个实例验证一下上述流程是否真的有用。<strong>第一步</strong>，先找一个属于常用图表类型的，并且相对较复杂的图。这里到 Apache 官网的示例上去找，就用如下<a target="_blank" rel="noopener" href="https://echarts.apache.org/examples/zh/editor.html?c=line-aqi">这个图</a>，看起来花里胡俏挺唬人的。<del>这个图印象中 gallery.echarts.org 好像有个类似的例子，这里我们假装不知道先来自己做一下。</del></p>
<p><img src="https://paradiseeee.github.io/post-assets/20201221/example.png"></p>
<p>首先把 option 的内容折叠起来以免自己偷看作弊。它上面的数据没有直接写入 option 变量，而是用 jquery 加载的，我没找到接口在哪，所以就在 option 里面加了个 dataView 工具，然后运行，在数据视图中将数据 copy 下来，保存为 <code>data.csv</code>（文末可以下载）。</p>
<p><strong>第二步</strong>，粗略地画个草图。就是一个主题为 <code>pyecharts.globals.ThemeType.DARK</code> 的折线图，横轴为时间，纵轴为 AQI 数值。页面上加了标题、工具箱、图例、数据缩放工具四个组件。</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> pyecharts <span class="token keyword">import</span> charts <span class="token keyword">as</span> pyc
<span class="token keyword">from</span> pyecharts <span class="token keyword">import</span> options <span class="token keyword">as</span> opts
<span class="token keyword">from</span> pyecharts <span class="token keyword">import</span> <span class="token builtin">globals</span> <span class="token keyword">as</span> glbs

data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'data.csv'</span><span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">'\t'</span><span class="token punctuation">)</span>
line <span class="token operator">=</span> pyc<span class="token punctuation">.</span>Line<span class="token punctuation">(</span>init_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>InitOpts<span class="token punctuation">(</span>theme<span class="token operator">=</span>glbs<span class="token punctuation">.</span>ThemeType<span class="token punctuation">.</span>DARK<span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token string">'100%'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span>
    <span class="token builtin">list</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span>
    <span class="token string">'Beijing AQI'</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
line<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div></figure>

<p>首先画个最简单的图，结果长下面那样。对比一下，缺了上面提到的三个组件。图例默认有了，但是不是我们想要的样子。工具提示显示格式一样了，但是触发方式不一样，下图中要悬停到具体的点上才能触发。折线上多了数据标签，主图背景少了些分割线，等等。</p>
<p><img src="https://paradiseeee.github.io/post-assets/20201221/1.png"></p>
<p>然后先简单地使用默认参数，把完整的 options 加上去。可以看到加上组件了，已经离目标接近很多了。</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">line<span class="token punctuation">.</span>set_series_opts<span class="token punctuation">(</span>
    label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>is_show<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
    title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'Beijing AQI'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    legend_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LegendOpts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    visualmap_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>VisualMapOpts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    datazoom_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>DataZoomOpts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    tooltip_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TooltipOpts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    toolbox_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>ToolboxOpts<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
line<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div></figure>

<p><img src="https://paradiseeee.github.io/post-assets/20201221/2.png"></p>
<p><strong>第三、四、五步</strong>其实就是一个循环迭代的过程，用这个思路来修改每一个 options。接下来根据上图与原图不同的地方，具体定义组件的 options 参数：</p>
<p>Title 这里位置太靠边了，原图离最左边有点空隙：</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">line<span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
    title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'Beijing AQI'</span><span class="token punctuation">,</span> pos_left<span class="token operator">=</span><span class="token string">'1%'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
<span class="token punctuation">)</span></code></pre></div></figure>

<p>Legend 这里想了很久，不知道怎么改成原图那样。后来跳过了，做下面的内容才发现原图那个不是 Legend，而是 Visual Map 产生的图例。所以这里就简单把 Legend 禁用了就行了：</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">line<span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
    legend_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LegendOpts<span class="token punctuation">(</span>is_show<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span></code></pre></div></figure>

<p>Viusal Map 这里明显的区别是，原图那个是离散的，这里目前是连续的，所以先找个参数将它离散化。然后需要定义一下分割的区间。这里我先是凭感觉写了个参数，发现不对，便上 <a target="_blank" rel="noopener" href="https://pyecharts.org/#/zh-cn/global_options?id=visualmapopts%ef%bc%9a%e8%a7%86%e8%a7%89%e6%98%a0%e5%b0%84%e9%85%8d%e7%bd%ae%e9%a1%b9">官网</a> 查看了一下文档如下。至于每个区间的颜色，可以用取色器在原图获取：</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># 自定义的每一段的范围，以及每一段的文字，以及每一段的特别的样式。例如：</span>
<span class="token comment"># pieces: [</span>
<span class="token comment">#   &#123;"min": 1500&#125;, // 不指定 max，表示 max 为无限大（Infinity）。</span>
<span class="token comment">#   &#123;"min": 900, "max": 1500&#125;,</span>
<span class="token comment">#   &#123;"min": 310, "max": 1000&#125;,</span>
<span class="token comment">#   &#123;"min": 200, "max": 300&#125;,</span>
<span class="token comment">#   &#123;"min": 10, "max": 200, "label": '10 到 200（自定义label）'&#125;,</span>
<span class="token comment">#   &#123;"value": 123, "label": '123（自定义特殊颜色）', "color": 'grey'&#125;,</span>
<span class="token comment">#   &#123;"max": 5&#125;     // 不指定 min，表示 min 为无限大（-Infinity）。</span>
<span class="token comment"># ]</span>
pieces<span class="token punctuation">:</span> Optional<span class="token punctuation">[</span>Sequence<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span></code></pre></div></figure>

<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">line<span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
    visualmap_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>VisualMapOpts<span class="token punctuation">(</span>
        is_piecewise<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> pos_top<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> pos_right<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>
        pieces<span class="token operator">=</span><span class="token punctuation">[</span>
            <span class="token punctuation">&#123;</span><span class="token string">'min'</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'max'</span><span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token string">'color'</span><span class="token punctuation">:</span> <span class="token string">'#93CE07'</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#123;</span><span class="token string">'min'</span><span class="token punctuation">:</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token string">'max'</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">'color'</span><span class="token punctuation">:</span> <span class="token string">'#FBDB0F'</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#123;</span><span class="token string">'min'</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">'max'</span><span class="token punctuation">:</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token string">'color'</span><span class="token punctuation">:</span> <span class="token string">'#FC7D02'</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#123;</span><span class="token string">'min'</span><span class="token punctuation">:</span><span class="token number">150</span><span class="token punctuation">,</span> <span class="token string">'max'</span><span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">'color'</span><span class="token punctuation">:</span> <span class="token string">'#FD0100'</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#123;</span><span class="token string">'min'</span><span class="token punctuation">:</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">'max'</span><span class="token punctuation">:</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token string">'color'</span><span class="token punctuation">:</span> <span class="token string">'#AA069F'</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#123;</span><span class="token string">'min'</span><span class="token punctuation">:</span><span class="token number">300</span><span class="token punctuation">,</span> <span class="token string">'color'</span><span class="token punctuation">:</span> <span class="token string">'#AC3B2A'</span><span class="token punctuation">&#125;</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span> 
<span class="token punctuation">)</span></code></pre></div></figure>

<p>Data Zoom 组件默认显示 20%-80%，看一下文档，发现有个 start_value 参数，由于原图中就是显示最后一部分，所以可以使用这个参数搞定。但是第一次试了发现不行，原因是它已经给开始结束位置设置了默认值，所以要先将这两个值设为空值，start_value 参数才有效。另外发现原图是可以在主图里面直接拖动的，所以要改一下 type 参数。这里就出现问题了，改了 type 之后，里面可以拖动了，但是外面的滚动条不见了。这里只好查看原图的代码抄答案，原来它用数组的形式定义了两个 Data Zoom 组件，一个在里面，一个在外面：</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">line<span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
    datazoom_opts<span class="token operator">=</span><span class="token punctuation">[</span>
        opts<span class="token punctuation">.</span>DataZoomOpts<span class="token punctuation">(</span>
            start_value<span class="token operator">=</span><span class="token string">'2014-06-01'</span><span class="token punctuation">,</span> range_start<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> range_end<span class="token operator">=</span><span class="token boolean">None</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span> 
        opts<span class="token punctuation">.</span>DataZoomOpts<span class="token punctuation">(</span>type_<span class="token operator">=</span><span class="token string">'inside'</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span> 
<span class="token punctuation">)</span></code></pre></div></figure>

<p>Tooltip 组件需要更改触发方式，简单加上 trigger 参数即可：</p>
<figure><div class="code-wrapper"><pre class="language-none"><code class="language-none">1
line.set_global_opts(tooltip_opts&#x3D;opts.TooltipOpts(trigger&#x3D;&#39;axis&#39;))</code></pre></div></figure>

<p>Toolbox 组件多了一堆按钮，简单研究一下文档，把不必要的删掉就 OK。实际写时发现 pyecharts 的那个缺点又出现了，就是太多 options 对象。执行 <code>opts.ToolBoxFeatureOpts?</code> 就可以看到，可以说看了头皮发麻。所以这里用字典传参，只需要把 python 中的变量名用下划线分割单词的习惯，改成 js 中用首字母大写分割单词，参数基本就对应上了。然后用字典代替 options 对象就行了。然后还要改一下它的位置，原图是靠右对齐，并且离最右边留有一点空隙，这里因为也已经有默认参数，一样要先把默认参数置空：</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">line<span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
    toolbox_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>ToolboxOpts<span class="token punctuation">(</span>
        pos_left<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> pos_right<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>
        feature<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'dataZoom'</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token string">'restore'</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token string">'saveAsImage'</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span></code></pre></div></figure>

<p>然后好像还差点什么？没错，Y 轴的分割线。估计应该是在 yaxis_opts 里添加，于是试一下。发现分割线是有了，但是还差那些带箭头的虚线，查了一下文档，发现应该在 <code>set_series_opts</code> 里面通过 <code>opts.MarkLineOpts</code> 设置：</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">line<span class="token punctuation">.</span>set_series_opts<span class="token punctuation">(</span>
    markline_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>MarkLineOpts<span class="token punctuation">(</span>
        label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>position<span class="token operator">=</span><span class="token string">'end'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        linestyle_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LineStyleOpts<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token string">'#333'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        data<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token string">'yAxis'</span><span class="token punctuation">:</span> y<span class="token punctuation">&#125;</span> <span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span></code></pre></div></figure>

<p>最后主图的位置和原图不太一样，通过 grid 属性改一下。参考第四节中提到的关于<a target="_blank" rel="noopener" href="https://paradiseeee.github.io/2020/12/21/PyEcharts-%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/#%E9%81%87%E5%88%B0%E4%B8%8D%E6%94%AF%E6%8C%81%E6%88%96%E6%97%A0%E6%95%88%E7%9A%84%E5%8F%82%E6%95%B0%E6%80%8E%E4%B9%88%E5%8A%9E">参数无效</a>的问题：</p>
<figure><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">line<span class="token punctuation">.</span>options<span class="token punctuation">[</span><span class="token string">'grid'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'left'</span><span class="token punctuation">:</span> <span class="token string">'6%'</span><span class="token punctuation">,</span> <span class="token string">'right'</span><span class="token punctuation">:</span> <span class="token string">'15%'</span><span class="token punctuation">,</span> <span class="token string">'bottom'</span><span class="token punctuation">:</span> <span class="token string">'12%'</span><span class="token punctuation">&#125;</span></code></pre></div></figure>

<p>结果如下，基本与原图一样了。有细微区别是因为 Apache 网站上的图表容器跟这里的不一样，并且上面的网页截图时浏览器开了扩展 DarkReader，所以颜色也有点改变的地方。</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://paradiseeee.github.io/post-assets/20201221/render.html">在新标签页打开交互式图表</a> | <a target="_blank" rel="noopener" href="https://paradiseeee.github.io/post-assets/20201221/code.py">下载完整绘图代码</a> | <a target="_blank" rel="noopener" href="https://paradiseeee.github.io/post-assets/20201221/data.csv">下载数据</a></p>
</blockquote>
<p><img src="https://paradiseeee.github.io/post-assets/20201221/3.png"></p>
<hr>
<p>鸣谢 &amp; 推荐：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_27484665">@AwesomeTang</a></p>
<p><strong>END</strong></p>
<blockquote>
<p>原文链接：<a target="_blank" rel="noopener" href="https://paradiseeee.github.io/2020/12/21/PyEcharts-%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/">https://paradiseeee.github.io/2020/12/21/PyEcharts-%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/</a></p>
</blockquote>
<hr>

            </div>

            
                <div class="post-copyright-info">
                    
<div class="article-copyright-info-container">
    <ul class="copyright-info-content">
        <li class="post-title">
            <span class="type">Post title</span>: <span class="content">PyEcharts学习总结</span>
        </li>
        <li class="post-author">
            <span class="type">Post author</span>: <span class="content">Marsh</span>
        </li>
        <li class="post-time">
            <span class="type">Create time</span>: <span class="content">2022-11-13 00:12:17</span>
        </li>
        <li class="post-link">
            <span class="type">Post link</span>: <span class="content">2022/11/13/pyecharts学习总结/</span>
        </li>
        <li class="post-license">
            <span class="type">Copyright notice</span>: <span class="content">All articles in this blog are licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> unless stating additionally.</span>
        </li>
    </ul>
    <div class="copy-copyright-info flex-center tooltip" data-content="Copy copyright info" data-offset-y="-2px">
        <i class="fa-solid fa-copy"></i>
    </div>
</div>

                </div>
            

            
                <ul class="post-tags-box">
                    
                        <li class="tag-item">
                            <a href="../../../../tags/%E5%8E%9F%E5%88%9B/">#原创</a>&nbsp;
                        </li>
                    
                        <li class="tag-item">
                            <a href="../../../../tags/Python/">#Python</a>&nbsp;
                        </li>
                    
                </ul>
            

            
                <div class="article-nav">
                    
                        <div class="article-prev">
                            <a class="prev"
                               rel="prev"
                               href="../../14/hexo%E6%8A%A5%E9%94%99/"
                            >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                                <span class="title flex-center">
                                <span class="post-nav-title-item">hexo d博客部署报错</span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                            </a>
                        </div>
                    
                    
                        <div class="article-next">
                            <a class="next"
                               rel="next"
                               href="../../12/Markdown%E8%AF%AD%E6%B3%95/"
                            >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Markdown语法</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                                <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                            </a>
                        </div>
                    
                </div>
            

            
                <div class="comment-container">
                    
<div class="comments-container">
    <div id="comments-anchor"></div>
    <div class="comment-area-title">
        <i class="fas fa-comments"></i>&nbsp;Comments
    </div>
    
        
            

    <div class="gitalk-comment-container">
        <div id="gitalk-container"></div>
        <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk/dist/gitalk.css">
        <script data-pjax src="//cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js"></script>
        <script data-pjax>
          function loadGitalk() {
            let __gitalk__pathname = decodeURI(location.pathname);
            const __gitalk__pathnameLength = __gitalk__pathname.length;
            const __gitalk__pathnameMaxLength = 50;
            if (__gitalk__pathnameLength > __gitalk__pathnameMaxLength) {
              __gitalk__pathname = __gitalk__pathname.substring(0, __gitalk__pathnameMaxLength - 3) + '...';
            }

            try {
              Gitalk && new Gitalk({
                clientID: 'ab165842dc9a64de37e9',
                clientSecret: '96d2589a9e0310efa2bf996a5f5e88ef8b7b3557#',
                repo: 'hexo-site-coments',
                owner: 'jaling9',
                admin: 'jaling9',
                id: __gitalk__pathname,
                proxy: '',
                language: 'en'
              }).render('gitalk-container');
            } catch (e) {
              window.Gitalk = null;
            }
          }

          if ('true' === 'true') {
            const loadGitalkTimeout = setTimeout(() => {
              loadGitalk();
              clearTimeout(loadGitalkTimeout);
            }, 1000);
          } else {
            window.addEventListener('DOMContentLoaded', loadGitalk);
          }
        </script>
    </div>



        
    
</div>

                </div>
            
        </div>

        
            <div class="toc-content-container">
                <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E7%AE%80%E4%BB%8B-%E2%80%93-Echarts-amp-PyEcharts"><span class="nav-text">一、简介 – Echarts &amp; PyEcharts</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Echarts"><span class="nav-text">Echarts</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PyEcharts"><span class="nav-text">PyEcharts</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E5%B8%B8%E7%94%A8%E5%9B%BE%E8%A1%A8"><span class="nav-text">二、常用图表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E9%80%89%E9%A1%B9%E9%85%8D%E7%BD%AE"><span class="nav-text">三、选项配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8-options"><span class="nav-text">常用 options</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93"><span class="nav-text">经验总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9B%E3%80%81%E8%BF%9B%E9%98%B6%E6%8A%80%E5%B7%A7"><span class="nav-text">四、进阶技巧</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9B%B4%E6%8D%A2-echarts-min-js-%E7%9A%84%E5%BC%95%E7%94%A8%E6%BA%90"><span class="nav-text">更换 echarts.min.js 的引用源</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E6%95%B0%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-text">参数数据类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%81%87%E5%88%B0%E4%B8%8D%E6%94%AF%E6%8C%81%E6%88%96%E6%97%A0%E6%95%88%E7%9A%84%E5%8F%82%E6%95%B0%E6%80%8E%E4%B9%88%E5%8A%9E"><span class="nav-text">遇到不支持或无效的参数怎么办</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%90%E7%94%A8-css-%E5%92%8C-js-%E6%8E%A7%E5%88%B6%E8%A7%86%E8%A7%89%E6%95%88%E6%9E%9C"><span class="nav-text">运用 css 和 js 控制视觉效果</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%90%E7%94%A8-js-%E6%8E%A7%E5%88%B6%E4%BA%A4%E4%BA%92%E6%95%88%E6%9E%9C"><span class="nav-text">运用 js 控制交互效果</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%94%E3%80%81%E6%80%BB%E7%BB%93"><span class="nav-text">五、总结</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B4%E4%BD%93%E6%80%9D%E8%B7%AF"><span class="nav-text">整体思路</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E4%BE%8B%E9%AA%8C%E8%AF%81"><span class="nav-text">实例验证</span></a></li></ol></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            
<footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
                <span>2020</span> -
            
            2023
            
                &nbsp;<i class="fas fa-heart icon-animate"></i>
                &nbsp;<a href="/">Marsh</a>
            
        </div>
        
            <script async data-pjax
                    src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    Visitor Count&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                
                
                    Totalview&nbsp;<span id="busuanzi_value_site_pv"></span>
                
            </div>
        
        <div class="theme-info info-item">
            Powered by <a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;|&nbsp;Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.6.1</a>
        </div>
        
        
            <div class="deploy-info info-item">
                
                    This site is provided with deployment services by <span class="tooltip" data-content="GitHub Pages"><img src="/images/deploy-provider/github.png"></span>
                
            </div>
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="tools-item flex-center go-to-comments">
                <i class="fas fa-comment"></i>
                <span class="post-comments-count"></span>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/dark-light-toggle.js"></script>




    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/local-search.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/code-block.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/lazyload.js"></script>


<div class="post-scripts pjax">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/post-helper.js"></script>
        
            <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/libs/anime.min.js"></script>
        
        
            <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/toc.js"></script>
        
    
</div>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
